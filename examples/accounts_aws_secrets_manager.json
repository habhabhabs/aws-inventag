{
  "version": "1.0",
  "encrypted": false,
  "accounts": [
    {
      "account_id": "123456789012",
      "account_name": "Production Account",
      "regions": ["us-east-1", "us-west-2", "eu-west-1"],
      "services": ["EC2", "S3", "RDS", "Lambda", "ECS", "EKS"],
      "tags": {
        "Environment": "production",
        "Owner": "platform-team",
        "CostCenter": "engineering"
      }
    },
    {
      "account_id": "123456789013",
      "account_name": "Staging Account",
      "regions": ["us-east-1", "us-west-2"],
      "services": ["EC2", "S3", "RDS", "Lambda"],
      "tags": {
        "Environment": "staging",
        "Owner": "platform-team"
      }
    },
    {
      "account_id": "123456789014",
      "account_name": "Development Account",
      "regions": ["us-east-1"],
      "services": ["EC2", "S3", "Lambda"],
      "tags": {
        "Environment": "development",
        "Owner": "dev-team"
      }
    }
  ],
  "global_config": {
    "default_regions": ["us-east-1", "us-west-2"],
    "default_services": ["EC2", "S3", "RDS", "Lambda"],
    "max_concurrent_accounts": 3,
    "continue_on_error": true,
    "retry_attempts": 3
  },
  "metadata": {
    "created_by": "AWS Environment",
    "created_date": "2024-01-15",
    "description": "AWS environment configuration using AWS Secrets Manager for credential storage",
    "environment": "aws-native",
    "credential_management": {
      "method": "aws_secrets_manager",
      "description": "AWS credentials are stored in AWS Secrets Manager and retrieved at runtime",
      "secrets_configuration": {
        "production_account": {
          "secret_name": "inventag/credentials/production",
          "secret_arn": "arn:aws:secretsmanager:us-east-1:123456789012:secret:inventag/credentials/production-AbCdEf",
          "region": "us-east-1",
          "keys": {
            "access_key_id": "aws_access_key_id",
            "secret_access_key": "aws_secret_access_key",
            "session_token": "aws_session_token"
          }
        },
        "staging_account": {
          "secret_name": "inventag/credentials/staging",
          "secret_arn": "arn:aws:secretsmanager:us-east-1:123456789012:secret:inventag/credentials/staging-GhIjKl",
          "region": "us-east-1",
          "keys": {
            "access_key_id": "aws_access_key_id",
            "secret_access_key": "aws_secret_access_key"
          }
        },
        "development_account": {
          "secret_name": "inventag/credentials/development",
          "secret_arn": "arn:aws:secretsmanager:us-east-1:123456789012:secret:inventag/credentials/development-MnOpQr",
          "region": "us-east-1",
          "keys": {
            "access_key_id": "aws_access_key_id",
            "secret_access_key": "aws_secret_access_key"
          }
        }
      },
      "setup_instructions": [
        "1. Create secrets in AWS Secrets Manager for each account",
        "2. Store credentials as JSON with keys: aws_access_key_id, aws_secret_access_key, aws_session_token (optional)",
        "3. Grant the execution role permissions to read these secrets",
        "4. Configure environment variables to specify which secrets to use for each account",
        "5. The InvenTag credential manager will automatically retrieve credentials at runtime"
      ],
      "required_iam_permissions": [
        "secretsmanager:GetSecretValue",
        "secretsmanager:DescribeSecret"
      ]
    },
    "environment_variables": {
      "INVENTAG_SECRET_PROD": "inventag/credentials/production",
      "INVENTAG_SECRET_STAGING": "inventag/credentials/staging",
      "INVENTAG_SECRET_DEV": "inventag/credentials/development",
      "AWS_DEFAULT_REGION": "us-east-1"
    },
    "secret_format_example": {
      "description": "Each secret should contain a JSON object with AWS credentials",
      "example": {
        "aws_access_key_id": "AKIAIOSFODNN7EXAMPLE",
        "aws_secret_access_key": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",
        "aws_session_token": "optional-session-token-for-temporary-credentials"
      }
    },
    "codebuild_integration": {
      "buildspec_reference": "examples/aws_codebuild_with_secrets_manager.yml",
      "description": "AWS CodeBuild can automatically access Secrets Manager with proper IAM permissions"
    },
    "security_best_practices": [
      "✅ Credentials encrypted at rest in AWS Secrets Manager",
      "✅ Automatic credential rotation support",
      "✅ Fine-grained IAM access control",
      "✅ Audit trail through CloudTrail",
      "✅ No credentials in code or configuration files",
      "✅ Cross-account access with proper IAM roles"
    ]
  }
}